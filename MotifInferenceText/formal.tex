%%This is a very basic article template.
%%There is just one section and two subsections.
\documentclass[12pt]{article}
\usepackage{latexsym}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage[brazil]{babel}
\usepackage[latin1]{inputenc}
\usepackage[normalem]{ulem}
\usepackage[portuguese]{alg}
\usepackage[dvips]{graphicx}

\usepackage{alg}
\usepackage{float}
\floatstyle{ruled}
\newfloat{algorithm}{htbp}{loa}%[chapter]
\newcommand{\listofalgorithms}{\listof{algorithm}{Lista de Algoritmos}}
\floatname{algorithm}{Algoritmo}

%Teoremas, Lemas, etc.
\newtheorem{teorema}{Teorema}[section]
\newtheorem{lema}[teorema]{Lema}
\newtheorem{proposicao}[teorema]{Proposição}
\newtheorem{observacao}[teorema]{Observação}
\newtheorem{corolario}[teorema]{Corolário}
\newtheorem{definicao}[teorema]{Definição}
\newtheorem{exemplo}[teorema]{Exemplo}
\newtheorem{problema}[teorema]{Problema}
\newenvironment{prova}[1][Prova.]{\begin{trivlist}
\item[\hskip \labelsep {\itshape #1}]}{\end{trivlist}}
\newenvironment{comentario}[1][Comentário]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}


\newcommand{\tq}{\mathrel{|}}
\newcommand{\weightsym}{\phi}
\newcommand{\weight}[1]{\function{\weightsym}{#1}}
\newcommand{\invert}[1]{\mathord{\overline{{#1}}}}
\newcommand{\invertsym}{\mathord{\overline{\ \ {\vspace{3 mm}}}}}
\newcommand{\aplica}{\longrightarrow}
\newcommand{\implica}{\Longrightarrow}
\newcommand{\sse}{\Longleftrightarrow}
\newcommand{\natset}{\ensuremath{\mathbb{N}}}
\newcommand{\intset}{\ensuremath{\mathbb{Z}}}
\newcommand{\realset}{\ensuremath{\mathbb{R}}}
\newcommand{\tabenum}{\hspace{20 pt}}

\newcommand{\seq}{seqüência}
\newcommand{\seqs}{seqüências}
\newcommand{\subasubg}{subárvore de subgrafos}
\newcommand{\asubg}{árvore de subgrafos}
\newcommand{\asubgc}{árvore de subgrafos conexos}
\newcommand{\Asubg}{Árvore de subgrafos}
\newcommand{\assubg}{árvores de subgrafos}
\newcommand{\assubgc}{árvores de subgrafos conexos}

\newcount\hour
\newcount\minute
\hour=\time \divide \hour by 60 \minute=\time \loop \ifnum \minute
> 59 \advance \minute by -60 \repeat
\def\now{%
\ifnum \hour<13 \ifnum \hour<1 12:\else\number\hour:\fi \ifnum
\minute<10 0\fi
\number\minute%
%\ifnum \hour<12 \ AM \else \ PM \fi
\else \advance \hour by -12 \number\hour:%
\ifnum \minute<10 0\fi
\number\minute%
%\ PM%
\fi%
}
\let\oldthepage=\thepage
\renewcommand{\thepage}{\today{} \now \qquad (\oldthepage)}

\newcommand{\cqd}{\nobreak \ifvmode \relax \else
      \ifdim\lastskip<1.5em \hskip-\lastskip
      \hskip1.5em plus0em minus0.5em \fi \nobreak
      \vrule height0.75em width0.5em depth0.25em\fi}


\newcommand{\alfcolor}{\ensuremath{\Sigma}}
\newcommand{\colorSym}{\ensuremath{c}}
\newcommand{\motifSym}{\ensuremath{m}}
\newcommand{\fmotifSym}{\ensuremath{motif}}
\newcommand{\fmotif}[1]{\ensuremath{\fmotifSym (#1)}}
\newcommand{\fcolorSym}{\ensuremath{color}}
\newcommand{\fcolor}[1]{\ensuremath{\fcolorSym (#1)}}
\newcommand{\subgraphSym}{\ensuremath{\widehat{s}}}
\newcommand{\subgraphconSym}{\ensuremath{s}}
\newcommand{\setsubgraphconSym}{\ensuremath{S}}
\newcommand{\setsubgSym}{\ensuremath{\widehat{\setsubgraphconSym}}}
\newcommand{\setsubgcSym}{\ensuremath{S}}
\newcommand{\setsubgc}[1]{\ensuremath{\setsubgcSym(#1)}}
\newcommand{\setsubgcsSym}{\ensuremath{I}}
\newcommand{\setsubgcs}[2]{\ensuremath{\setsubgcsSym(#1,#2)}}
\newcommand{\setsubgcsemSym}{\ensuremath{N}}
\newcommand{\setsubgcsem}[2]{\ensuremath{\setsubgcsemSym(#1,#2)}}

\newcommand{\adj}[1]{\ensuremath{adj (#1)}}
\newcommand{\adjmaior}[1]{\ensuremath{adj^>(#1)}}
\newcommand{\subgempty}{\ensuremath{\subgraphconSym_{\emptyset}}}
\newcommand{\setsubgempty}{\ensuremath{\setsubgraphconSym_{\emptyset}}}
\newcommand{\distintos}[1]{\ensuremath{d(#1)}}

\newcommand{\nodeSym}{\ensuremath{n}}
\newcommand{\treeSym}{\ensuremath{T}}
\newcommand{\forestSym}{\ensuremath{F}}
\newcommand{\subtreeSym}[1]{\ensuremath{st(#1)}}
\newcommand{\treeSetSubg}[1]{\ensuremath{S}_{#1}}
\newcommand{\treeroot}[1]{\ensuremath{raiz}({#1})}

\begin{document}

\title{Procura de motifs}
\author{Augusto Fernandes Vellozo}

\maketitle

\section{Definições}

\begin{problema}\label{prob:listsubconexo}
Dado um grafo $G$ encontrar e listar todos os subgrafos conexos de $G$.
\end{problema}

Identificaremos um subgrafo \subgraphSym\ de $G$ pelo conjunto dos vértices
de \subgraphSym. Portanto, dados os subgrafos $\subgraphSym_1$ e
$\subgraphSym_2$, diremos que $\subgraphSym_1=\subgraphSym_2$ se e somente se
os vértices de $\subgraphSym_1$ são os mesmos vértices de $\subgraphSym_2$.

Assumiremos que existe uma ordem para os vértices de $G$. Desta forma, podemos
assumir que todo subgrafo de $G$ será representado pela \seq\ $(v_1, v_2,
\ldots, v_n)$ crescente de seus vértices.

Por exemplo, se 1, 2, 3 e 4 são vértices de $G$ e adotamos a ordem natural
dos vértices, então $(1,2,3)$ representa um subgrafo de $G$, assim como
$(1,2,4)$. Já $(2,1,4)$ e $(1,1,2,3)$ não representam um subgrafo de $G$.

\begin{definicao}[Função \fmotifSym] Dado um grafo $G=(V,E)$ e uma função
$\fcolorSym : V \aplica \alfcolor$, definimos a função $\fmotifSym : V^* \aplica
{\alfcolor}^*$ tal que, $\fmotif{\subgraphSym}=\{\fcolor{v_1}, \fcolor{v_2},
\ldots, \fcolor{v_n}\}$ onde $\subgraphSym=\{v_1, v_2, \ldots, v_n \}$.
\end{definicao}

Chamaremos a função $\fcolor{v}$ de cor de $v$. Assumiremos que existe uma
ordem para as cores dos vértices de $G$. Desta forma, podemos assumir que, para
um subgrafo \subgraphSym\ qualquer de $G$, o $\fmotif{\subgraphSym}$ será
representado pela \seq\ crescente das cores dos vértices de \subgraphSym.

Repare que qualquer cor pode ocorrer mais de uma vez em
$\fmotif{\subgraphSym}$. Por exemplo, se $V=\{1, 2, 3 , 4\}$ são os vértices de
$G$, $\fcolor{1}=A$, $\fcolor{2}=B$, $\fcolor{3}=A$, $\fcolor{4}=C$ e
assumimos as ordens natural  dos vértices e alfabética das cores, então
$\fmotif{(1,2,3)}$ é representado por $(A, A, B)$.

\begin{problema}\label{prob:infmotif}
Dado um grafo $G=(V,E)$ e uma função $\fmotifSym : V^* \aplica {\alfcolor}^*$
encontrar e listar todo par $(\motifSym, \setsubgraphconSym)$,  onde
$\motifSym=\fmotif{\subgraphconSym}$ $\forall\ \subgraphconSym \in
\setsubgraphconSym$  e \subgraphconSym\ é um subgrafo conexo de $G$. \motifSym
poderá ser limitado a um tamanho mínimo e/ou máximo.

%  $\motifSym$ é um
% \emph{multi-set} $\{\colorSym_1, \colorSym_2, \ldots \colorSym_n\}$, $\colorSym_i \in \Sigma^{\fcolorSym}$, $1 \leq i \leq n$ e $\setsubgraphconSym$ é um conjunto não vazio de subgrafos
% conexos de $G$, ou seja, $\setsubgraphconSym=\{\subgraphconSym_1,
% \subgraphconSym_2, \ldots, \subgraphconSym_n$, $\setsubgraphconSym \neq \emptyset$ e $\motifSym=\{\colorSym_1, \colorSym_2, \ldots \colorSym_n\}$, tal que $\colorSym_i \in \Sigma^{\fcolorSym}$, $1 \leq i \leq n$
\end{problema}

Diremos que o subgrafo conexo \subgraphconSym\ de $G$ é uma ocorrência de
\motifSym\ se $\fmotif{\subgraphconSym}=\motifSym$.

\begin{definicao}[\setsubgc{v}]
\setsubgc{v} é o conjunto de todos os subgrafos conexos e distintos de $G$ que
contém $v$.
\end{definicao}

\begin{definicao}[\setsubgcs{v}{v'}]
\setsubgcs{v}{v'} é o conjunto de todos os subgrafos conexos e distintos de $G$
que contém $v$ e que cujo menor vértice é v'.
\end{definicao}

\begin{definicao}[\setsubgcsem{v}{v'}]
\setsubgcsem{v}{v'} é o conjunto de todos os subgrafos conexos e distintos de
$G$ que contém $v$ e que não contém v'.
\end{definicao}

Portanto se $(v_1, v_2, \ldots,
v_n) \in \setsubgcs{v}{v'}$ então $v_1=v'$ e $v_i=v$ para algum $i$, $1 \leq i
\leq n$.

Sejam $v$ e $v'$ vértices de $G$ tais que $v' <v$. Temos
que:

$$\setsubgc{v}=\setsubgcs{v}{v} \bigcup_{v_1 < v} \setsubgcs{v}{v_1}\ e$$

$$\setsubgc{v}=\setsubgcs{v}{v} \cup \setsubgcs{v}{v'} \bigcup_{v_1\tq v'<v_1<v}
 \setsubgcs{v}{v_1} \bigcup_{v_2\tq v_2<v'}
\setsubgcs{v}{v_2} .$$

Se $v'$ é o menor vértice em $G$, então $$\setsubgc{v}=\setsubgcs{v}{v} \cup
\setsubgcs{v}{v'}  \bigcup_{v_1\tq v'<v_1<v} \setsubgcs{v}{v_1}\mbox{, ou
seja}$$
$$\setsubgc{v}=\bigcup_{v_1\tq v'\leq v_1\leq v}\setsubgcs{v}{v_1}.$$

Logo, se $v$ é o menor vértice em $G$, então
$$\setsubgc{v}=\setsubgcs{v}{v}.$$

Dados dois subgrafos $\subgraphSym_1$ e $\subgraphSym_2$ de $G$ temos que
$$\subgraphSym_1 \cup \subgraphSym_2 = (v_1, v_2, \ldots, v_n) \tq v_i \in
\subgraphSym_1 \mbox{ e/ou } v_i \in
\subgraphSym_2, 1 \leq i \leq n \mbox{ e } v_{i'} < v_{i'+1}, 1 \leq i' < n.$$

Portanto $|\subgraphSym_1|+|\subgraphSym_1| \geq |\subgraphSym_1\cup
\subgraphSym_2|$.

\begin{observacao}\label{obs:uniaosubgrafos}
Sejam $\subgraphconSym_1$ e $\subgraphconSym_2$ dois subgrafos conexos de
$G$ tais que existe pelo menos um vértice $v$ que está em $\subgraphconSym_1$ e
$\subgraphconSym_2$. Temos que $\subgraphconSym_1 \cup \subgraphconSym_2$ é um
subgrafo conexo de $G$.
\end{observacao}

O produto cartesiano de dois conjuntos de subgrafos $\setsubgSym_1$ e
$\setsubgSym_2$ é dado por: $$\setsubgSym_1 \times
\setsubgSym_2=\{\subgraphSym_1 \cup
\subgraphSym_2,\ \forall\ \subgraphSym_1 \in \setsubgSym_1\ e\
\forall\ \subgraphSym_2 \in \setsubgSym_2\}. $$

O produto cartesiano de $n$ conjuntos de subgrafos $\setsubgSym_1,
\setsubgSym_2, \ldots, \setsubgSym_n$ é dado por: $$\setsubgSym_1 \times
\setsubgSym_2 \times \ldots \times \setsubgSym_2=
\prod_{i=1}^{n}\setsubgSym_i=\{\subgraphSym \tq \subgraphSym=
\bigcup_{i=1}^{n}\subgraphSym_i \mbox{, onde } \subgraphSym_i \in
\setsubgSym_i\}. $$



O produto cartesiano de um vértice de $G$ e um conjunto de subgrafos de $G$ é
dado por $$v \times \setsubgSym = \{v \cup \subgraphSym,\ \forall\ \subgraphSym
\in \setsubgSym\}.$$

\begin{observacao}\label{obs:selfcartesian}
Baseado na Observação \ref{obs:uniaosubgrafos} podemos fazer as seguintes
afirmações:
\begin{itemize}
  \item $\forall \setsubgcSym \tq \setsubgcSym \subseteq
  \setsubgc{v}$ temos que $\distintos{\setsubgc{v}\times
  \setsubgcSym}=\setsubgc{v}$
  \item $\forall\setsubgcSym \tq \setsubgcSym \subseteq
  \setsubgcs{v}{v'}$ temos que $\distintos{\setsubgcs{v}{v'}\times
  \setsubgcSym}=\setsubgcs{v}{v'}$
  \item $\forall\setsubgcSym \tq \setsubgcSym \subseteq
  \setsubgcsem{v}{v'}$ temos que $\distintos{\setsubgcsem{v}{v'}\times
  \setsubgcSym}=\setsubgcsem{v}{v'}$
\end{itemize}
\end{observacao}


Denotaremos \adj{v}\ como o conjunto de vértices de $G$ que são vizinhos de $v$
e \adjmaior{v}\ como o conjunto de vértices de $G$ que são vizinhos de $v$ e
maiores que $v$.

Denotaremos o subgrafo vazio, ou seja o subgrafo sem vértices nem arestas, como
\subgempty\ e diremos que $\{\subgempty\}=\setsubgempty$. Diremos também que
para qualquer conjunto de subgrafos $\setsubgSym$ de $G$ teremos
$\setsubgSym \times \setsubgempty = \setsubgSym$.

Dado um conjunto de subgrafos \setsubgSym, denotaremos por
$\distintos{\setsubgSym}$ o conjunto dos subgrafos de \setsubgSym\ que são
distintos.

Podemos dizer que
$$\setsubgc{v}=\distintos{\{v \times \prod_{\forall v_i \in \adj{v}}
(\setsubgc{v_i}\cup \setsubgempty)\}}\mbox{ e}$$
$$\setsubgc{v}=\{v \times \distintos{\prod_{\forall v_i \in \adj{v}}
(\setsubgcsem{v_i}{v}\cup \setsubgempty)}\}.$$

Se $v$ é o menor vértice de $G$, podemos dizer que
$$\setsubgcs{v}{v}=\setsubgc{v}=\{v \times \distintos{\prod_{\forall v_i \in \adj{v}}
(\setsubgcsem{v_i}{v}\cup \setsubgempty)}\}.$$

Podemos dizer que $\setsubgcsem{v_i}{v}=\bigcup_{\forall v_j\tq v< v_j\leq
v_i}\setsubgcs{v_i}{v_j}$. Logo,

$$\setsubgc{v}=\{v \times \distintos{\prod_{\forall v_i \in
\adj{v}} ((\bigcup_{\forall v_j\tq v< v_j\leq v_i}\setsubgcs{v_i}{v_j})\cup
\setsubgempty)}\}$$

% $$=\{v \times \distintos{\prod_{\forall v_i \in
% \adj{v}}(\setsubgcs{v_i}{v_i}\cup \setsubgempty)
% \times \prod_{\forall v_i \in
% \adj{v}} (\bigcup_{\forall v_j\tq v< v_j< v_i
% \mbox{ e } v_j \notin \adj{v}}(\setsubgcs{v_i}{v_j}\cup \setsubgempty))}\}$$
%
\section{\Asubg}

Cada nó de uma \asubg\ \treeSym\ tem os seguintes atributos:
\begin{enumerate}
  \item v: a identificação de um vértice no grafo $G$
  \item filhos: uma lista com os nós filhos na árvore. Se $v'$ e $v''$ são
  filhos de $v$ então $v'\neq v''$ e $v'> v$.
  \item pai: o nó pai na árvore (para a raiz este atributo é nulo)
  \item altura: a altura na árvore
  \item tipo: terminal ou não terminal
\end{enumerate}

Chamaremos de $\treeroot{\treeSym}$ o nó raiz de \treeSym.

Podemos dizer que uma \asubg\ \treeSym\ representa os subgrafos de $G$
que podem ser representados por um caminho de $\treeroot{\treeSym}$ até um nó
terminal de \treeSym.

Diremos que $\treeSetSubg{\treeSym}$ é o conjunto dos subgrafos representados
por \treeSym.

Uma \asubgc\ é uma \asubg\ tal que todo caminho da raiz até um nó terminal
representa um subgrafo conexo em $G$, ou seja, se \treeSym\ é uma \asubgc\
então $\forall\ \subgraphSym \in \treeSetSubg{\treeSym}$ temos que
\subgraphSym\ é conexo.

\begin{problema}
Construir uma floresta \forestSym\ de \assubgc\ tal que todo subgrafo
conexo de $G$ está contido em uma e somente uma das \assubgc\ de \forestSym.
\end{problema}

Iremos construir as \assubgc\ de $G$ de tal forma que cada vértice
de $G$ seja raiz de uma só árvore. Portanto, a \asubgc\ do vértice
$v$ deverá conter todos e somente os subgrafos conexos de $G$ que comecem com
$v$. Logo, se \treeSym\ é a \asubgc\ do vértice
$v$ então $\treeSetSubg{\treeSym}=\setsubgcs{v}{v}$.

Dados um nó \nodeSym\ de uma \asubg\ \treeSym, chamaremos  de
\subtreeSym{\nodeSym} a subárvore obtida a partir do nó \nodeSym\ e seus
descendentes. A subárvore \subtreeSym{\nodeSym} representa todos os subgrafos
que podem ser obtidos de um caminho de \nodeSym\ até um nó terminal de
\subtreeSym{\nodeSym}.

\begin{observacao}
Dados dois nós $\nodeSym_1$ e $\nodeSym_2$ de \assubgc, podemos dizer que o
produto cartesiano $\treeSetSubg{\subtreeSym{\nodeSym_1}}\times
\treeSetSubg{\subtreeSym{\nodeSym_2}}$ é dado por:

$$\nodeSym_1.v \times \left(\left(\bigcup_{\nodeSym_1' \in
\nodeSym_1.filhos} (\treeSetSubg{\subtreeSym{\nodeSym_1'}}) \cup
\setsubgempty^{\nodeSym_1}\right) \times
\treeSetSubg{\subtreeSym{\nodeSym_2}}\right)\mbox{, se } \nodeSym_1.v < \nodeSym_2.v$$
$$\nodeSym_2.v \times \left(\left(\bigcup_{\nodeSym_2' \in
\nodeSym_2.filhos} (\treeSetSubg{\subtreeSym{\nodeSym_2'}}) \cup
\setsubgempty^{\nodeSym_2}\right) \times
\treeSetSubg{\subtreeSym{\nodeSym_1}}\right)\mbox{, se }  \nodeSym_2.v < \nodeSym_1.v$$
$$\nodeSym_1.v \times \left(\left(\bigcup_{\nodeSym_1' \in
\nodeSym_1.filhos} (\treeSetSubg{\subtreeSym{\nodeSym_1'}}) \cup
\setsubgempty^{\nodeSym_1}\right) \times \left(\bigcup_{\nodeSym_2' \in
\nodeSym_2.filhos} (\treeSetSubg{\subtreeSym{\nodeSym_2'}}) \cup
\setsubgempty^{\nodeSym_2}\right)\right)\mbox{, se }  \nodeSym_1.v =
\nodeSym_2.v$$


, onde $$\setsubgempty^{\nodeSym_1}=\left\{\begin{array}{ll}\setsubgempty &
\mbox{, se } \{\nodeSym_1.v\} \in \treeSetSubg{\subtreeSym{\nodeSym_1}}\\
\emptyset &\mbox{, caso contrário.}\end{array}\right.$$
e
$$\setsubgempty^{\nodeSym_2}=\left\{\begin{array}{ll}\setsubgempty &
\mbox{, se } \{\nodeSym_2.v\} \in \treeSetSubg{\subtreeSym{\nodeSym_2}}\\
\emptyset &\mbox{, caso contrário.}\end{array}\right.$$

\end{observacao}

\section{Algoritmos}

Dados duas subárvores $\treeSym_1$ e $\treeSym_2$ tais que
$\treeroot{\treeSym_1}.v< \treeroot{\treeSym_2}.v$, o algoritmo
\ref{alg:cartesian} constrói a subárvore \treeSym\ tal que
$\treeSetSubg{\treeSym}=\treeSetSubg{\treeSym_1}\times \{\treeSetSubg{\treeSym_2}
\cup \emptyset\}$.
\end{document}
